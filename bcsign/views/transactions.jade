extends layout
block content
	script(type='text/javascript').
		$(document).ready(function () {
				$(window).load(function () {

					var documents = new Array();

					notaryContract.DocumentEvent({}, {fromBlock: 0, toBlock: "latest"}).watch(function (a, b) {

						var hash = web3.toAscii(b.args.hash);

						for (var i = 0; i < documents.length; i++) {
							if (documents[i].hash === hash && documents[i].to === b.args.to) {
								doc = documents[i];
							}
						}

						if (typeof doc !== "undefined") {
							return;
						}

						documents.push({hash: hash, to: b.args.to, from: b.args.from, blockNumber: b.args.blockNumber.toString()});

						var table = document.getElementById("transactionTable");

						var row = table.insertRow();

						var cell1 = row.insertCell(0);
						var cell2 = row.insertCell(1);
						var cell3 = row.insertCell(2);
						var cell4 = row.insertCell(3);

						cell1.innerHTML = hash;
						cell2.innerHTML = "<a href='https://etherchain.org/account/" + b.args.from +"'>" + b.args.from + "</a>";
						cell3.innerHTML = "<a href='https://etherchain.org/account/" + b.args.to.toString() +"'>" + b.args.to.toString() + "</a>";
						cell4.innerHTML = "<a href='https://etherchain.org/block/" + b.args.blockNumber.toString() +"'>" + b.args.blockNumber.toString() + "</a>";
					});
				});
			});
	.container
		h2 List of transactions:
			table.table.table-striped
				thead
					tr
						th(style='min-width:200px') Hash
						th(style='min-width:200px') From
						th(style='min-width:200px') To
						th(style='min-width:50px') Block number
				tbody#transactionTable(style='font-size: 10pt;')
